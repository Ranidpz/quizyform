# Quizy Cloud Storage Form

טופס הרשמה לשירות אחסון קבצים של Quizy.

## תיאור

מערכת טפסים לרישום לשירותי אחסון של קוויזי גיים. הטופס שולח את הנתונים באמצעות PHP ו-Resend API.

## קבצי המערכת

- `index.html` - דף הטופס הראשי
- `thank_you.html` - דף תודה לאחר שליחת הטופס
- `error.html` - דף שגיאה מותאם אישית
- `send-mail.php` - סקריפט PHP לשליחת מיילים באמצעות Resend API
- `approve.php` - סקריפט PHP לאישור מנוי ושליחת מייל אישור ללקוח
- `form-handler.php` - קובץ העברה לתאימות עם קוד ישן
- `styles.css` - עיצוב הטופס
- `script.js` - קוד JavaScript לטיפול בטופס
- `.htaccess` - הגדרות אבטחה ונתיבים לשרת Apache

## הוראות התקנה

### 1. העלאת הקבצים לשרת

העלה את כל הקבצים לתיקיית היעד בשרת, לדוגמה:

```
/var/www/quizy_subscription_form/
```

### 2. הגדרת הרשאות קבצים

הגדר הרשאות מתאימות לקבצים ולתיקיות:

```bash
# הרשאות לתיקיות
chmod 755 .
chmod 755 media/

# הרשאות לקבצי PHP
chmod 644 *.php

# יצירת תיקיות לוגים ועותקי מיילים
mkdir -p logs debug_emails
chmod 755 logs debug_emails
chmod 666 form_submissions.log
```

### 3. הגדרת מפתח API

מפתח ה-API של Resend מוגדר ישירות בקבצים `send-mail.php` ו-`approve.php`:

```php
$resend_api_key = 're_STacfGs3_DaWkfkqzEvQsu2VsSm2kygxV';
```

בסביבת ייצור, מומלץ להחליף את המפתח למפתח ייצור אמיתי.

## בדיקת המערכת

### בדיקת שליחת מייל

לבדיקת תקינות שליחת המיילים:

1. גש לכתובת: `https://your-domain.com/quizy_subscription_form/test-php-email.php`
2. בדוק שהמייל נשלח בהצלחה
3. בדוק שהתקבל מייל בכתובת `info@playzone.co.il`

**הערה חשובה**: לאחר הבדיקה, הסר את קובץ `test-php-email.php` מהשרת בסביבת ייצור!

### בדיקת הטופס

1. גש לכתובת: `https://your-domain.com/quizy_subscription_form/`
2. מלא את הטופס ושלח אותו
3. ודא שאתה מופנה לדף תודה
4. בדוק שהתקבלו שני מיילים:
   - מייל למנהל (info@playzone.co.il) עם פרטי ההזמנה וכפתור אישור
   - מייל ללקוח עם פרטי ההזמנה וקישור לתשלום

### בדיקת תהליך האישור

1. במייל שהתקבל אצל המנהל, לחץ על כפתור "אשר ללקוח שהמנוי פעיל"
2. ודא שמוצג דף אישור המציין שהמייל נשלח בהצלחה
3. בדוק שהלקוח קיבל מייל אישור המציין שהמנוי פעיל

## הגדרות אבטחה

הקובץ `.htaccess` מכיל הגדרות אבטחה חשובות:

1. הגנה על קבצים רגישים
2. הגדרות PHP מאובטחות
3. הגדרות HTTP Security Headers
4. הפניית HTTP ל-HTTPS (אם מוגדר בשרת)
5. הגנה על תיקיות לוגים ועותקי מיילים

## פתרון בעיות נפוצות

### המייל לא נשלח

1. בדוק שמפתח ה-API תקין בקבצים `send-mail.php` ו-`approve.php`
2. בדוק שהדומיין מאומת ב-Resend
3. בדוק את קובץ הלוג ב-`form_submissions.log`
4. בדוק את תיקיית `debug_emails` לראות אם נוצרו עותקים של המיילים

### שגיאות PHP

1. בדוק את לוגים של השרת ב-`/var/log/apache2/error.log` או `/var/log/nginx/error.log`
2. הפעל זמנית את הצגת השגיאות בקובצי PHP:
   ```php
   ini_set('display_errors', 1);
   ```

### בעיות בטופס

1. בדוק שכל השדות הנדרשים מולאו
2. בדוק שהטופס מופנה לכתובת הנכונה ב-`action`
3. בדוק את קונסולת הדפדפן לשגיאות JavaScript

## תהליך שליחת הטופס

1. המשתמש ממלא את הטופס ב-`index.html`
2. בלחיצה על "שליחת הטופס", JavaScript מנסה לשלוח את הנתונים ל-`/send-email` (API נתיב)
3. אם API לא זמין, הטופס נשלח ישירות ל-`send-mail.php` כגיבוי
4. `send-mail.php` שולח שני מיילים:
   - מייל למנהל עם פרטי ההזמנה וכפתור אישור
   - מייל ללקוח עם פרטי ההזמנה וקישור לתשלום
5. המשתמש מופנה לדף `thank_you.html`
6. לאחר שהלקוח משלם, המנהל לוחץ על כפתור האישור במייל
7. `approve.php` שולח מייל אישור ללקוח שהמנוי פעיל

## קישורי תשלום

המערכת משתמשת בקישורי תשלום של YaadPay בהתאם לחבילה שנבחרה:

- בסיסי (2GB): קישור תשלום YaadPay עם סכום של 35 ₪
- מתקדם (5GB): קישור תשלום YaadPay עם סכום של 71 ₪
- פרימיום (10GB): קישור תשלום YaadPay עם סכום של 118 ₪
- פרו (15GB): קישור תשלום YaadPay עם סכום של 159 ₪
- אולטימייט (20GB): קישור תשלום YaadPay עם סכום של 189 ₪

הקישורים כוללים את כל הפרמטרים הנדרשים לתשלום, כולל חתימה דיגיטלית.

## הערות חשובות

1. המערכת שולחת שני מיילים בעת שליחת הטופס:
   - מייל למנהל (info@playzone.co.il) עם פרטי ההזמנה וכפתור אישור
   - מייל ללקוח עם פרטי ההזמנה וקישור לתשלום
2. לאחר אישור המנהל (לחיצה על הכפתור במייל), נשלח מייל אישור ללקוח
3. כתובת השולח מוגדרת כ-`onboarding@resend.dev` (דומיין מאומת של Resend)
4. הקוד יוצר קובץ לוג `form_submissions.log` עם פרטי השליחות
5. עותקים של המיילים נשמרים בתיקיית `debug_emails`
6. בסביבת ייצור, יש להסיר את קובץ `test-php-email.php`

## מידע נוסף

לשאלות נוספות או תמיכה, צור קשר עם צוות התמיכה:
- טלפון: 077-300-6306
- אימייל: info@playzone.co.il 